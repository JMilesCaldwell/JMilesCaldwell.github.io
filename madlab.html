<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <!-- A viewport meta to make things more pleasant on mobile. -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, 
    minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Evershroud Chronicles: A Little Strategy Romp</title>

  <!-- Fonts as used in your existing code -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Almendra&family=Cinzel:wght@400;700&display=swap"
    rel="stylesheet"
  />

  <!-- Simple styling that borrows from your existing aesthetic. -->
  <style>
    body {
      margin: 0;
      background: url("resources/index.png") no-repeat center center fixed;
      background-size: cover;
      color: #FAF4E0;
      font-family: 'Almendra', serif;
      text-align: center;
    }
    h1, h2, h3 {
      font-family: 'Cinzel', serif;
      margin: 0.5rem 0;
    }
    .container {
      max-width: 600px;
      margin: 1rem auto;
      background: rgba(0, 0, 0, 0.7);
      padding: 1rem;
      border-radius: 10px;
      text-align: left;
    }
    .btn {
      background: #8B0000;
      color: #FAF4E0;
      padding: 0.5rem 1rem;
      border: 2px solid #660000;
      border-radius: 5px;
      cursor: pointer;
      font-family: 'Cinzel', serif;
      margin: 0.3rem;
      text-decoration: none;
    }
    .btn:hover {
      background: #660000;
    }
    .flex-row {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      justify-content: center;
    }
    .faction-card {
      background: rgba(255, 255, 255, 0.1);
      border: 2px solid #660000;
      border-radius: 8px;
      width: 140px;
      padding: 0.5rem;
      text-align: center;
      cursor: pointer;
      transition: transform 0.2s;
    }
    .faction-card:hover {
      transform: scale(1.05);
    }
    .faction-card img {
      max-width: 100%;
      border: 2px solid #8B0000;
      border-radius: 4px;
    }
    .selected {
      border-color: #FFD700 !important;
      box-shadow: 0 0 10px #FFD700;
    }
    .game-section {
      margin-top: 1rem;
      padding: 1rem;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid #660000;
      border-radius: 8px;
    }
    .resource-display {
      margin-bottom: 1rem;
      padding: 0.5rem;
      background: rgba(0,0,0,0.5);
      border: 1px solid #8B0000;
      border-radius: 5px;
    }
    .location-card {
      background: rgba(255,255,255,0.1);
      border: 1px solid #660000;
      border-radius: 5px;
      margin: 0.5rem 0;
      padding: 0.5rem;
    }
    .location-card:hover {
      background: rgba(255,255,255,0.15);
    }
    .hidden {
      display: none;
    }
    /* Mobile adaptation: ensure things scale nicely. */
    @media (max-width: 600px) {
      .faction-card {
        width: 120px;
      }
    }
  </style>
</head>
<body>

<div class="container" id="introContainer">
  <h1>Evershroud Chronicles</h1>
  <p>
    Well met, traveller. You stand poised to carve your legacy among the swirling mists 
    of the Isles—ally with cunning factions, gather resources, and survive curious 
    encounters. <em>Choose your affiliation</em>, if you dare...
  </p>

  <!-- Faction selection row -->
  <div class="flex-row" id="factionRow">
    <!-- We will populate these from JS for convenience -->
  </div>

  <button class="btn" id="startGameBtn">Begin Your Journey</button>
</div>

<div class="container hidden" id="gameContainer">
  <h2 id="factionTitle"></h2>
  <div class="resource-display">
    <strong>Resources:</strong> <span id="resourceGold"></span> gold, 
    <span id="resourceInfluence"></span> influence
  </div>

  <div class="game-section">
    <h3>Available Locations</h3>
    <div id="locationList"></div>
  </div>

  <div class="game-section">
    <h3>Random Encounter</h3>
    <p>Whenever you travel or dabble in mischief, something curious may unfold.</p>
    <button class="btn" id="encounterBtn">Test Your Luck</button>
    <div id="encounterResult" style="margin-top: 0.5rem;"></div>
  </div>
</div>

<script>
/* 
   ================   SIMPLE DATA   ================
   We'll define a handful of factions, referencing some 
   names from your world. We'll also define a few locations 
   (like the Temple District or Alchemist Shop) that we can 
   “travel” to, purely for flavour. 
*/
const factions = [
  {
    id: "azure",
    name: "Azurean League",
    image: "resources/azure.png",
    desc: "A loose federation of city-states with princely rule—prosperous in maritime trade."
  },
  {
    id: "silt",
    name: "Hegemony of Silt",
    image: "resources/silt.png",
    desc: "A theocratic domain under the Cult of Rael, known for its mercenary forces."
  },
  {
    id: "margraeve",
    name: "Margraeve-Duskhaven",
    image: "resources/margraeve.png",
    desc: "A realm of undead aristocracy, bound by dark rites but ironically joyful citizens."
  },
  {
    id: "caldwell",
    name: "Caldwell Republic",
    image: "resources/caldwell.png",
    desc: "Nominal democracy overshadowed by Silt, once the breadbasket of the Isles."
  }
];

const locations = [
  {
    name: "Alchemist’s Shop",
    desc: "A pungent den of potions and concoctions. Possibly dangerous, definitely expensive.",
    effect: () => {
      // Example effect on resources
      const cost = getRandomInt(10, 50);
      if (player.gold >= cost) {
        player.gold -= cost;
        player.influence += 1;
        return `You spent ${cost} gold on arcane goo, gaining a whiff of influence (+1).`;
      } else {
        return `You cannot afford these splendidly bizarre potions. The alchemist sneers.`;
      }
    }
  },
  {
    name: "Temple District",
    desc: "Seek the blessings of the Five—if your gold can appease them.",
    effect: () => {
      const donation = getRandomInt(2, 20);
      if (player.gold >= donation) {
        player.gold -= donation;
        player.influence += 2;
        return `You donate ${donation} gold, receiving a minor divine favour (+2 influence).`;
      } else {
        return `You approach the altars empty-handed. The priests politely show you the door.`;
      }
    }
  },
  {
    name: "Council Hall",
    desc: "A seat of intrigue where deals are struck in hushed tones.",
    effect: () => {
      // If influence is high, maybe gain gold.
      if (player.influence >= 5) {
        const gain = getRandomInt(10, 30);
        player.gold += gain;
        player.influence -= 2; 
        return `Leveraging your clout, you broker a small deal: +${gain} gold, -2 influence.`;
      } else {
        return `The council politely notes your lack of status. No deals for you.`;
      }
    }
  },
  {
    name: "The Pickled Piglet",
    desc: "A notorious tavern where rogues, ruffians, and potential allies lurk.",
    effect: () => {
      // Maybe random effect
      const roll = Math.random();
      if (roll < 0.5) {
        player.gold -= 5;
        player.influence += 1;
        return `You buy a round for the ruffians (-5 gold), forging a new connection (+1 influence).`;
      } else {
        const stolen = Math.min(player.gold, getRandomInt(5, 15));
        player.gold -= stolen;
        return `A cunning pickpocket lightens your purse by ${stolen} gold while you’re tipsy.`;
      }
    }
  }
];

/* Some random encounters for the “Test Your Luck” button. */
const encounters = [
  "A passing merchant drops a pouch in haste. Gain 10 gold!",
  "A swarm of gulls descends upon your rations. Lose 5 gold for a replacement meal.",
  "A robed figure extols the virtues of another realm; gain 2 influence for your open-mindedness.",
  "Caught in an alley scuffle—lose 2 influence as your reputation gets tarnished.",
  "A spontaneous festival enthralls you; you spend 8 gold but gain 1 influence dancing with the locals.",
  "You unearth a hidden trinket—sellable for 15 gold!",
  "You help an old fisherman mend his net; in gratitude, he discreetly slips you 5 gold.",
  "You offend a minor noble by stepping on their toe—lose 1 influence.",
  "A shadowy contact offers you hush money: +7 gold, but you feel slightly compromised…",
  "A petty guard fines you for a trumped-up violation—lose 5 gold."
];

/* 
   ================   GAME STATE   ================
   We'll store the player's chosen faction, resources, etc.
*/
let chosenFaction = null;
let player = {
  gold: 50,
  influence: 0
};

/* 
   ================   UTILITY   ================
*/
function getRandomInt(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min;
}

/* 
   ================   DOM MANIPULATION   ================
*/

// Step 1: Render faction cards
const factionRow = document.getElementById("factionRow");
factions.forEach(f => {
  const card = document.createElement("div");
  card.className = "faction-card";
  card.innerHTML = `
    <img src="${f.image}" alt="${f.name}">
    <h3>${f.name}</h3>
    <p style="font-size:0.8rem;">${f.desc}</p>
  `;
  card.onclick = () => {
    // Mark as selected
    document.querySelectorAll(".faction-card").forEach(c => c.classList.remove("selected"));
    card.classList.add("selected");
    chosenFaction = f;
  };
  factionRow.appendChild(card);
});

// Step 2: Begin game
const startGameBtn = document.getElementById("startGameBtn");
startGameBtn.onclick = () => {
  if (!chosenFaction) {
    alert("Pray choose a faction before plunging in, dear sir.");
    return;
  }
  document.getElementById("introContainer").classList.add("hidden");
  document.getElementById("gameContainer").classList.remove("hidden");
  document.getElementById("factionTitle").textContent = chosenFaction.name;
  updateResources();
  renderLocations();
};

// Step 3: Update resource display
function updateResources() {
  document.getElementById("resourceGold").textContent = player.gold;
  document.getElementById("resourceInfluence").textContent = player.influence;
}

// Step 4: Render location list
function renderLocations() {
  const locationList = document.getElementById("locationList");
  locationList.innerHTML = ""; // clear out old
  locations.forEach(loc => {
    const locDiv = document.createElement("div");
    locDiv.className = "location-card";
    locDiv.innerHTML = `
      <strong>${loc.name}</strong><br/>
      <em>${loc.desc}</em><br/>
      <button class="btn" style="margin-top:0.5rem;">Visit</button>
    `;
    locDiv.querySelector("button").onclick = () => {
      const result = loc.effect();
      alert(result);
      updateResources();
    };
    locationList.appendChild(locDiv);
  });
}

// Step 5: Encounters
document.getElementById("encounterBtn").onclick = () => {
  const e = encounters[Math.floor(Math.random() * encounters.length)];
  let resultMsg = e;

  // We can parse certain known patterns for quick resource changes:
  if (e.includes("Gain 10 gold")) {
    player.gold += 10;
  } else if (e.includes("Lose 5 gold")) {
    player.gold = Math.max(0, player.gold - 5);
  } else if (e.includes("gain 2 influence")) {
    player.influence += 2;
  } else if (e.includes("lose 2 influence")) {
    player.influence = Math.max(0, player.influence - 2);
  } else if (e.includes("spend 8 gold")) {
    player.gold = Math.max(0, player.gold - 8);
    player.influence += 1;
  } else if (e.includes("15 gold")) {
    player.gold += 15;
  } else if (e.includes("5 gold")) {
    // multiple references—just pick one
    if (e.includes("help an old fisherman")) {
      player.gold += 5;
    } else if (e.includes("guard fines")) {
      player.gold = Math.max(0, player.gold - 5);
    }
  } else if (e.includes("lose 1 influence")) {
    player.influence = Math.max(0, player.influence - 1);
  } else if (e.includes("+7 gold")) {
    player.gold += 7;
  }

  updateResources();
  document.getElementById("encounterResult").textContent = resultMsg;
};

</script>

</body>
</html>
