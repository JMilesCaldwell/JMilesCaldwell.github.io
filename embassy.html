<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Continental Embassy</title>
  <link 
    href="https://fonts.googleapis.com/css2?family=Almendra&family=Cinzel:wght@400;700&display=swap" 
    rel="stylesheet"
  >
  <style>
    /* General Page Styling */
    body {
      margin: 0;
      background: url('resources/councilhall.png') no-repeat center center fixed;
      background-size: cover;
      color: #FAF4E0;
      font-family: 'Almendra', serif;
      text-align: center;
    }

    .container {
      max-width: 900px;
      margin: 2rem auto;
      background: rgba(0, 0, 0, 0.7);
      padding: 2rem;
      border-radius: 10px;
    }

    h1, h2 {
      font-family: 'Cinzel', serif;
      margin: 0.5rem 0;
    }

    .faction-section {
      margin-bottom: 2rem;
      border: 2px solid #660000;
      border-radius: 8px;
      padding: 1rem;
      background: rgba(255, 255, 255, 0.1);
    }

    .faction-header {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 1rem;
    }

    .faction-img {
      width: 150px;  /* square faction image */
      height: 150px;
      border: 2px solid #8B0000;
      border-radius: 8px;
      object-fit: cover;
      margin-bottom: 0.5rem;
    }

    .faction-content {
      text-align: left;
      margin: 0.5rem 1rem;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 10px;
    }

    th, td {
      border: 1px solid #8B0000;
      padding: 0.5rem;
      text-align: center;
      vertical-align: middle;
    }

    th {
      background: #8B0000;
      color: #FAF4E0;
      font-family: 'Cinzel', serif;
    }

    .rep-portrait {
      width: 80px;  /* representative portrait size */
      height: 80px;
      border: 2px solid #660000;
      border-radius: 8px;
      object-fit: cover;
    }

    /* Buttons */
    .action-button, .home-button {
      background: #8B0000;
      color: #FAF4E0;
      border: 1px solid #660000;
      padding: 0.4rem 0.8rem;
      border-radius: 4px;
      cursor: pointer;
      font-family: 'Cinzel', serif;
      margin: 0.2rem;
      text-decoration: none;
    }
    .action-button:hover, .home-button:hover {
      background: #660000;
    }

    /* Modal Overlay */
    #modalOverlay {
      display: none;
      position: fixed;
      z-index: 999;
      left: 0; 
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.8); /* black overlay */
    }

    .modal-content {
      background-color: #2a2a2a;
      margin: 10% auto;
      padding: 1rem;
      border: 2px solid #660000;
      max-width: 500px;
      border-radius: 10px;
      position: relative;
      text-align: left;
    }
    .close-button {
      background: #8B0000;
      border: 1px solid #660000;
      color: #FAF4E0;
      padding: 0.3rem 0.6rem;
      cursor: pointer;
      font-family: 'Cinzel', serif;
      position: absolute;
      top: 1rem;
      right: 1rem;
      border-radius: 4px;
    }
    .close-button:hover {
      background: #660000;
    }

    label {
      display: block;
      margin-bottom: 0.5rem;
      font-family: 'Cinzel', serif;
    }

    input {
      width: 100%;
      padding: 0.4rem;
      margin-bottom: 0.8rem;
      box-sizing: border-box;
      font-family: 'Almendra', serif;
    }

    .divider {
      margin: 1rem auto;
      font-size: 1.5rem;
    }
    .divider::after {
      content: "✦ ✧ ✦";
      color: #8B0000;
      letter-spacing: 0.5rem;
    }
  </style>
</head>
<body>

  <div class="container">
    <h1>Continental Embassy</h1>
    <p>Welcome to the diplomatic nexus of the Isles. Here, envoys from distant lands gather.</p>

    <div class="divider"></div>

    <!-- Zhi-La -->
    <div class="faction-section">
      <div class="faction-header">
        <img src="resources/zilanfan.png" alt="Zhi-La" class="faction-img">
        <h2>Zhi-La</h2>
      </div>
      <div class="faction-content">
        <p>
          A realm of venerable traditions and enigmatic spirituality, Zhi-La thrives amidst its breathtaking landscapes of terraced mountains, serene rivers, and ancient pagodas. 
          The people of Zhi-La live in harmony with the spirits they believe animate all things, from stones to trees. Their intricate rituals and animistic philosophy underpin a society 
          that values balance above all else. The silent warrior-monks of Zhi-La are both scholars and protectors, wielding their mastery of martial arts and mystical disciplines to 
          safeguard their secrets. These secrets include potent alchemical formulas, esoteric magic, and a deep understanding of the natural and supernatural worlds.
        </p>
      </div>

      <!-- Representatives -->
      <table>
        <thead>
          <tr>
            <th>Portrait</th>
            <th>Name & Title</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <!-- Single Envoy -->
          <tr>
            <td>
              <img src="resources/zhi.png" alt="Chang Wu" class="rep-portrait">
            </td>
            <td>
              <strong>Chang Wu</strong><br>
              Zhilan Envoy
            </td>
            <td>
              <button class="action-button" onclick="openBribeModal('changwu')">Bribe</button>
              <button class="action-button" onclick="attemptAudience('changwu')">Request Audience</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Xondar -->
    <div class="faction-section">
      <div class="faction-header">
        <img src="resources/xondareye.png" alt="Xondar" class="faction-img">
        <h2>Xondar</h2>
      </div>
      <div class="faction-content">
        <p>
          A land of arid steppes and opulent coastal cities, Xondar is a patchwork of nomadic clans and mercantile powerhouses bound by necessity and ambition. 
          The Xondaran way is one of pragmatic survival, a harsh blend of desert traditions and coastal opportunism. The nomads of the interior live by the cycles 
          of the land, herding livestock and traversing dunes with an almost preternatural sense of direction. Meanwhile, the coastal sultanates revel in decadence 
          and cunning, their leaders adept at balancing trade and diplomacy with ruthless displays of power. Beneath their fine silks and gilded halls lies a culture 
          that respects strength, values gold, and upholds ancient, cryptic rites.
        </p>
      </div>

      <!-- Representatives -->
      <table>
        <thead>
          <tr>
            <th>Portrait</th>
            <th>Name & Title</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <!-- Single Envoy -->
          <tr>
            <td>
              <img src="resources/xondar.png" alt="Sultan Khalid ibn Al-Sharif" class="rep-portrait">
            </td>
            <td>
              <strong>Khalid ibn Al-Sharif</strong><br>
              Xondaran Trader
            </td>
            <td>
              <button class="action-button" onclick="openBribeModal('khalid')">Bribe</button>
              <button class="action-button" onclick="attemptAudience('khalid')">Request Audience</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- The Killian Jarls -->
    <div class="faction-section">
      <div class="faction-header">
        <img src="resources/killianramshead.png" alt="The Killian Jarls" class="faction-img">
        <h2>The Killian Jarls</h2>
      </div>
      <div class="faction-content">
        <p>
        From the frostbitten expanses of the north come the Killian Jarls, lords of a realm where survival is a relentless contest against nature itself. Their power
        stems from the unbroken bond between rider and steed, hunter and prey, elder and youth. This society prizes freedom above all else, eschewing the rigid hierarchies
        of southern lands for a way of life guided by shared oaths and ancestral wisdom. When they descend from their windswept ranges, it is with a fury akin to the 
        storms that shape their homeland—swift, unrelenting, and merciless.
        Despite their fearsome reputation, the Killian Jarls are bound by a deep sense of honor. Their oral histories, sung beneath the constellations of their vast skies,
        speak of gods who test the worthy and spirits who walk alongside the living. To break an oath or forsake a bond is a crime beyond forgiveness. 
        </p>
      </div>

      <!-- Representatives -->
      <table>
        <thead>
          <tr>
            <th>Portrait</th>
            <th>Name & Title</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <!-- Single Envoy -->
          <tr>
            <td>
              <img src="resources/killian.png" alt="Jarl Sigrun the Stormbringer" class="rep-portrait">
            </td>
            <td>
              <strong>Sigrun the Unyielding</strong><br>
              Killian Theign
            </td>
            <td>
              <button class="action-button" onclick="openBribeModal('sigrun')">Bribe</button>
              <button class="action-button" onclick="attemptAudience('sigrun')">Request Audience</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- HOME BUTTON AT THE BOTTOM -->
    <a href="index.html" class="home-button">Home</a>
  </div>

  <!-- Modal Overlay -->
  <div id="modalOverlay">
    <div class="modal-content">
      <button class="close-button" onclick="closeModal()">Close</button>
      <h2 id="modalTitle"></h2>
      <p id="modalDialogue"></p>

      <!-- Bribe input only shown if bribe mode -->
      <div id="bribeSection" style="display:none;">
        <label for="bribeAmount">Bribe Amount (GP):</label>
        <input type="number" id="bribeAmount" min="0" value="0" />
        <p id="bribeResult"></p>
        <button class="action-button" onclick="submitBribe()">Offer Bribe</button>
      </div>
    </div>
  </div>

  <script>
    /*******************************************************************
     *   REPRESENTATIVE DATA & SIMPLE BRIBE/AUDIENCE DEMO FUNCTIONALITY
     *******************************************************************/
    const REPS = {
      // Zhi-La
      changwu: {
        name: "Chang Wu, Celestial Governor of Zhi-La",
        minBribe: 50,
        maxBribe: 120,
        bribeSuccessChance: 0.70,
        audienceChance: 0.30,
        favorLines: [
          "A demonstration of ancient martial forms, bolstering your own soldiers' morale.",
          "A trove of rare medicinal herbs from Zhi-La’s mountain gardens.",
          "Subtle use of the Jade Court’s influence to soften a rival’s stance."
        ]
      },
      // Xondar
      khalid: {
        name: "Sultan Khalid ibn Al-Sharif, Lord of the Seven Sands",
        minBribe: 60,
        maxBribe: 150,
        bribeSuccessChance: 0.65,
        audienceChance: 0.25,
        favorLines: [
          "Conveying a desert caravan laden with exotic wares for you to resell.",
          "Commanding a squad of loyal steppe riders to scout treacherous routes for you.",
          "Issuing a call to arms that pressures your adversaries to stand down."
        ]
      },
      // Killian Jarls
      sigrun: {
        name: "Jarl Sigrun the Stormbringer, Chieftain of the Killian Horde",
        minBribe: 70,
        maxBribe: 170,
        bribeSuccessChance: 0.60,
        audienceChance: 0.20,
        favorLines: [
          "Dedicating a ferocious warband to defend your lands from outside incursions.",
          "A personal vow of fealty under the ancient rites, forging a short-term alliance.",
          "Teaching your warriors savage battle-songs that bolster their fighting spirit."
        ]
      }
    };

    let currentRepKey = null;
    let modalType = null;

    /* Open the bribe modal */
    function openBribeModal(repKey) {
      currentRepKey = repKey;
      modalType = 'bribe';
      document.getElementById("modalTitle").textContent = `Bribe Attempt: ${REPS[repKey].name}`;
      document.getElementById("modalDialogue").textContent = "What sum would you offer?";
      document.getElementById("bribeSection").style.display = "block";
      document.getElementById("bribeAmount").value = 0;
      document.getElementById("bribeResult").textContent = "";
      document.getElementById("modalOverlay").style.display = "block";
    }

    /* Attempt to submit a bribe */
    function submitBribe() {
      const rep = REPS[currentRepKey];
      const bribeValue = parseInt(document.getElementById("bribeAmount").value, 10) || 0;
      const bribeResult = document.getElementById("bribeResult");

      // Random threshold
      const threshold = getRandomInt(rep.minBribe, rep.maxBribe);
      if (bribeValue < threshold) {
        bribeResult.textContent = `Your bribe is too low. ${rep.name} declines. (Estimate threshold: ~${threshold} GP.)`;
        return;
      }

      // We met/exceeded the threshold; now chance to succeed
      const roll = Math.random();
      if (roll <= rep.bribeSuccessChance) {
        const favor = pickRandomLine(rep.favorLines);
        bribeResult.textContent = `Success! ${rep.name} is swayed and grants a favour: ${favor}`;
      } else {
        bribeResult.textContent = `${rep.name} pockets your gold but does nothing in return. How unfortunate!`;
      }
    }

    /* Attempt an audience */
    function attemptAudience(repKey) {
      const rep = REPS[repKey];
      const roll = Math.random();
      if (roll <= rep.audienceChance) {
        alert(`${rep.name} grants you a brief audience. Present your case with care.`);
      } else {
        alert(`${rep.name} denies your request. They remain distant and aloof.`);
      }
    }

    /* Close Modal */
    function closeModal() {
      document.getElementById("modalOverlay").style.display = "none";
      document.getElementById("bribeSection").style.display = "none";
    }

    /* Utility for random in [min, max] */
    function getRandomInt(min, max) {
      min = Math.ceil(min);
      max = Math.floor(max);
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    /* Utility pick random line from array */
    function pickRandomLine(arr) {
      const idx = Math.floor(Math.random() * arr.length);
      return arr[idx];
    }
  </script>
</body>
</html>
